<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
<!-- FORMS -->
	<!-- FORM res.partner establecimientos-->
    <record id="res_partner_establecimientos_inherit_form" model="ir.ui.view">
        <field name="name">res.partner.establecimientos.view.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
           	<xpath expr="//page[@string='Contacts']" position="before">
        		<page string="Productos">    		
    				<group string="Productos Contratados">
    					<field name="product_contratado_cliente_ids" nolabel="1"/>	    					
           			</group>
          			</page>
	   			<page string="Establecimientos" attrs="{'invisible': [('is_company','=',False), ('child_ids', '=', [])]}">
	 				<group string="Establecimiento">	 						 						 						  					
        				<field name='establecimiento_ids' widget='many2many_kanban' nolabel="1" context="{'res_partner_id':id}">
        				    <kanban>
						        <field name="name"/>						       
						        <templates>
					                <t t-name="kanban-box">
					                	<a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">x</a>
					                    <div class="oe_kanban_vignette oe_semantic_html_override">
					                    	<a type="open">
					                    		<img t-att-src="kanban_image('turismo.establecimiento', 'imagen', record.id.value)"  class="oe_kanban_image"/>
					                    	</a>
					                    	<div class="oe_kanban_details">
					                    		<h4><a type="open"> <field name="name"/></a></h4>
					                    		<h4><field name="tipo"/></h4>
					                    		<ul>
													<li t-if="record.city.raw_value">
														<field name="city"/>
													</li>													
					                    		</ul>
					                    	</div>
					                    </div>
					                </t>
						        </templates>
						    </kanban>
        				</field>
       				</group>	        		       				      		
        		</page>       				        		
        	</xpath>	        	        
        </field>	        
    </record>
    <!-- FORM de un servicio de establecimiento -->
	<record id="establecimiento_service_view_form" model="ir.ui.view">
        <field name="name">establecimiento.services.form</field>
        <field name="model">establecimiento.services</field>  	
        <field name="arch" type="xml">
        	<form string="Servicio" create="false">	            		
       			<group string="Datos del servicio ofrecio por el establecimiento" colspan="4">
	         		<field name="name"/>
					<field name="description"/>
					<field name="icon"/>			
       			</group>
       			<a href="http://fontawesome.io/icons/" target="_blank">** Ver Iconos disponibles</a>
        	</form>	
        </field>
    </record>
    
    <!-- TREE de un servicio de establecimiento -->
    <record id="establecimiento_services_view_tree" model="ir.ui.view">
 		<field name="name">Servicios</field>
 		<field name="model">establecimiento.services</field>	 		
		<field name="type">tree</field>
		<field name="arch" type="xml">
		<tree string="Servicios">
			<field name="name"/>
			<field name="icon"/>
			<field name="description"/>       	
		</tree>
		</field>
	</record>
    
    <!-- FORM de un Establecimiento -->
	<record id="establecimientxo_view_form" model="ir.ui.view">
            <field name="name">establecimiento.form</field>
            <field name="model">turismo.establecimiento</field>  	
            <field name="arch" type="xml">
            	<form string="Establecimiento" create="false">	            		
           			<group string="Datos del Establecimiento" colspan="4">
           				<field name="website_published" class="pull-right" widget="website_button"/>
	            		<field name="name"/>
	            		<field name="tipo"/>
	            		<field name="res_partner_id" attrs="{'required':1}"/>
	            		<field name="parent_id" attrs="{'invisible':1}"/>
	            		<field name="descripcion"/>
	            		<field name="longitud"/>
	            		<field name="latitud"/>	            		
	            		<field name='idiomas' widget="many2many_tags"/>
	            		<field name="imagen"/>
						<field name="tripadvisor_url"/>						
           			</group>
           				<div>
                                <div class="oe_edit_only">
                                    <field name="use_parent_address" class="oe_inline"
                                           on_change="onchange_address(use_parent_address, parent_id)"/>
                                    <label for="use_parent_address"/>
                                </div>
                                <button name="open_parent" type="object" string="(edit company address)" class="oe_link oe_edit_only"
                                        attrs="{'invisible': ['|',('parent_id','=', False),('use_parent_address','=',False)]}"/>
                                <field name="street" placeholder="Street..."  attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                <field name="street2"  attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                <div class="address_format">
                                    <field name="city" placeholder="City" style="width: 40%%" attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                    <field name="state_id" class="oe_no_button" placeholder="State" style="width: 37%%" options='{"no_open": True}' on_change="onchange_state(state_id)" attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                    <field name="zip" placeholder="ZIP" style="width: 20%%" attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                </div>
                                <field name="country_id" placeholder="Country" class="oe_no_button" options='{"no_open": True, "no_create": True}' attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                        </div>
           			<notebook colspan="4">
           				<page string="Imagenes Establecimiento">
						   <field name="images">
						        <tree editable="bottom">
									<field name="name"/>
									<field name="image" widget="image" height="64"/>							
									<field name="sequence"/>
									<field name="more_view_exclude"/>
						        </tree>
						   </field>
	                    </page>
	                    <page string="Servicios">
						   <field name="services">
						        <tree editable="bottom">
									<field name="name"/>
									<field name="description"/>							
									<field name="icon"/>
						        </tree>
						   </field>
	                    </page>
	           		</notebook>
                   	            		
            	</form>	
            </field>
    </record>
    <!-- SEARCH establecimientos para agregar filtros por tipos de establecimiento -->
	<record model="ir.ui.view" id="establecimiento_turismo_view_search">
        <field name="name">tipos.establecimiento.search</field>
        <field name="model">turismo.establecimiento</field> 
        <field name="arch" type="xml">
        <search string="Establecimientos">
        	<filter name= "bodega" string="Bodegas" domain="[['tipo', '=', 'bodega']]" />				
			<filter name= "restaurante" string="Restaurantes" domain="[['tipo', '=', 'restaurante']]" />
			<filter name= "vinhedo" string="ViÃ±edos" domain="[['tipo', '=', 'vinhedo']]" />
			<filter name= "hospedaje" string="Hospedajes" domain="[['tipo', '=', 'hospedaje']]" />
			<filter name= "cultural" string="Arte y Cultura" domain="[['tipo', '=', 'cultural']]" />
			<filter name= "vinoteca" string="Vinotecas" domain="[['tipo', '=', 'vinoteca']]" />
			<filter name= "otro" string="Otros" domain="[['tipo', '=', 'otro']]" />
		</search>
		</field>
	</record>
	
    <record id="clientes_view_tree" model="ir.ui.view">
 		<field name="name">Clientes</field>
 		<field name="model">res.partner</field>	 		
		<field name="type">tree</field>
		<field name="arch" type="xml">
		<tree string="Clientes">
			<field name="name"/>
			<field name="establecimiento_ids" widget="one2many"/>
            <field name="function" invisible="1"/>
            <field name="phone"/>
            <field name="email"/>
            <field name="user_id" invisible="1"/>
            <field name="is_company" invisible="1"/>
            <field name="country_id" invisible="1"/>
            <field name="parent_id" invisible="1"/>	        	
		</tree>
		</field>
	</record>
	
	<record id="establecimientos_view_tree" model="ir.ui.view">
 		<field name="name">establecimientos</field>
 		<field name="model">turismo.establecimiento</field>	 		
		<field name="type">tree</field>
		<field name="arch" type="xml">
		<tree string="Establecimiento">
			<field name="name"/>
			<field name="website_published"/>
	        <field name="tipo"/>
	        <field name="res_partner_id"/>   	
		</tree>
		</field>
	</record>
<!-- KANBAN -->
<!--  VISTAS KANBAN -->
    <record id="establecimientos_kanban" model="ir.ui.view">
        <field name="name">Tablero de Establecimientos</field>
        <field name="model">turismo.establecimiento</field>        
        <field name="arch" type="xml">       	
   		<kanban>
	        <field name="name"/>
	        <templates>
                <t t-name="kanban-box">
                	<a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                    <div class="oe_kanban_vignette oe_semantic_html_override">
                    	<a type="open">
                    		<img t-att-src="kanban_image('turismo.establecimiento', 'imagen', record.id.value)"  class="oe_kanban_image"/>
                    	</a>
                    	<div class="oe_kanban_details">
                    		<h4><a type="open"> <field name="name"/></a></h4>
                    		<ul>
								 <div>
                                <div class="oe_edit_only">
                                    <field name="use_parent_address" class="oe_inline"
                                           on_change="onchange_address(use_parent_address, parent_id)"/>
                                    <label for="use_parent_address" attrs="{'invisible': ['|', ('is_company', '=', True), ('parent_id', '=', False)]}"/>
                                </div>
                                <button name="open_parent" type="object" string="(edit company address)" class="oe_link oe_edit_only"/>
                                <field name="street" placeholder="Street..."  attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                <field name="street2"  attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                <div class="address_format">
                                    <field name="city" placeholder="City" style="width: 40%%" attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                    <field name="state_id" class="oe_no_button" placeholder="State" style="width: 37%%" options='{"no_open": True}' on_change="onchange_state(state_id)" attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                    <field name="zip" placeholder="ZIP" style="width: 20%%" attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                                </div>
                                <field name="country_id" placeholder="Country" class="oe_no_button" options='{"no_open": True, "no_create": True}' attrs="{'readonly': [('use_parent_address','=',True)]}"/>
                            </div>													
                    		</ul>
                    	</div>
                    </div>
                </t>
	        </templates>
	    </kanban>		 	
        </field>
    </record>    
<!--  SEARCH -->
	<!-- SEARCH res.partner para agregar filtros por tipos de establecimiento -->
	<!-- record model="ir.ui.view" id="res_partner_turismo_view_inherit_search">
        <field name="name">tipos.establecimiento.search</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_res_partner_filter" /> 
        <field name="arch" type="xml">
        	<xpath expr="filter[@string='Suppliers']" position='after'>
        		<filter name= "tipo_establecimientos" string="Establecimientos"
        				domain="['|', '|', '!', ['bodega_nombre', '=', '-'], '!', ['restaurante_nombre', '=', '-'], '!', ['hospedaje_nombre', '=', '-']]" />
				<filter name= "tipo_bodega" string="Bodegas" domain="['!',('bodega_nombre','=','-')]" />
				<filter name= "tipo_restaurante" string="Restaurantes" domain="['!',('restaurante_nombre','=','-')]" />
				<filter name= "tipo_hospedaje" string="Hospedajes" domain="['!',('hospedaje_nombre','=','-')]" />								
			</xpath> 
		</field>
	</record-->
<!-- ACTIONS -->
	<record id="establecimiento_action_tree" model="ir.actions.act_window">		
		<field name="name">Establecimientos</field>
		<field name="res_model">turismo.establecimiento</field>		
		<field name="view_mode">tree,kanban,form</field>		
		<field name="view_type">form</field>
		<!-- field name="context">{'search_default_group_by_partner_id': 1}</field-->					 
	</record>
	
	<record id="establecimiento_servicios_action_tree" model="ir.actions.act_window">		
		<field name="name">Servicios</field>
		<field name="res_model">establecimiento.services</field>		
		<field name="view_mode">tree,form</field>		
		<field name="view_type">form</field>			 
	</record>
	
	</data>
</openerp>

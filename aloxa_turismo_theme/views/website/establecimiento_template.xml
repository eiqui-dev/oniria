<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>    
    
		<template id="establecimiento_details" name="Detalles Establecimiento" page="True">
			<t t-call="website.layout">
				<t t-set="additional_title" t-value="establecimiento.name"/>
				<div itemscope="itemscope" itemtype="http://schema.org/Product" id="wrap" class="js_sale establecimiento-page">
					<div class="page-title" style="padding:0 !important; border-style: none !important;">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="map-header" style="height:100%; position: absolute !important" alt="imgGoo"/>
			      		<div class="container" style="padding:50px 0 20px;">
							<div class="oe_structure"/>
						    <h1><span t-esc="establecimiento.name"/></h1>
						</div>
				    </div>
				
					<section class="container mt8 oe_website_sale" id="product_detail">
				         <div class="row">
							<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 product-detail">
		                		<span itemprop="image" t-field="establecimiento.imagen" t-field-options='{"widget": "image", "class": "product_detail_img product-image"}'/>
		                	</div>
							<div class="product-info"> 
								<div class="col-xs-12 col-md-5 col-lg-5 col-sm-6 product-detail">
									<div id="head-name">
						                <h1 t-esc="establecimiento.name" />
						                <div class="text-muted" t-esc="establecimiento.partner_id.get_composed_address(', ')" />
						            </div>
									<p t-esc="establecimiento.descripcion" class="text-muted text-justify"
										style="margin-top:1.5em;"/>   
								</div> 
								
								<div class="col-xs-12 col-md-3 col-lg-3 col-sm-12 product-detail"> 
									<div class="block-hours" t-if="establecimiento.horario and len(establecimiento.horario)>0">
										<h4>Horario</h4>
										<table>
											<tr t-foreach="establecimiento.horario" t-as="hln">
												<td><t t-esc="website.get_day_of_week(hln.dayofweek)" /></td><td style="text-align:right"><t t-esc="'%s – %s' % (website.get_float_hours(hln.hour_from), website.get_float_hours(hln.hour_to))" /></td>
											</tr>
										</table>
									</div>
									
									<t t-if="establecimiento.tripadvisor_url">
							        	<div id="TA_selfserveprop321" class="TA_selfserveprop">
											<ul id="YdAbOSysc8" class="TA_links Ed0roAdwga8x">
												<li id="bdLvBcTo04K" class="lqkgPPEUk">
													<a target="_blank" t-attf-href="#{ establecimiento.tripadvisor_url }"><img src="http://www.tripadvisor.es/img/cdsi/img2/branding/150_logo-11900-2.png" alt="TripAdvisor"/></a>
												</li>
											</ul>
										</div>
										<script t-attf-src="http://www.jscache.com/wejs?wtype=selfserveprop&amp;uniq=321&amp;locationId=#{ establecimiento.get_tripadvisor_id() }&amp;lang=es&amp;rating=true&amp;nreviews=5&amp;writereviewlink=true&amp;popIdx=true&amp;iswide=false&amp;border=true&amp;display_version=2"></script>
									</t>
								</div> 
							</div>
						</div>
						<div class="row" style="margin-top:2em;">
					  		<div id="events" class="col-md-12 col-lg-12">
					  			<hr style="margin-bottom:0;"/>
					  			<div class="row">
					  				<h4 class="detail-section-title"><strong>Eventos</strong></h4>
					  			</div>
						  		<h3 t-if="len(events) == 0" class="text-muted text-center">No existen eventos programados</h3>
						  		<table t-if="len(events) > 0" class="table table-condensed table-hover table-striped" id="table-events">
									<thead>
										<th>Evento</th>
										<th>Fecha Inicio</th>
										<th>Fecha Fin</th>
										<th>Mapa</th>
										<th> </th>
									</thead>
									<tbody>
										<tr t-foreach="events" t-as="event">
											<td style="text-align:left; vertical-align: middle;">
												<h4 style="margin:0" t-esc="event.name" />
											</td>
											<td><span t-field="event.date_begin" /></td>
											<td><span t-field="event.date_end" /></td>
											<td><a href="#" data-toggle="modal" data-target="#map-viewer" class="open-map-image" t-attf-data-address="#{event.address_id.get_composed_address(',')}">Ver mapa</a></td>
											<td><a t-attf-href="/event/#{slug(event)}/register" class="btn btn-primary">Reservar</a></td>
										</tr>
									</tbody>
								</table>
							</div>
							<div id="products" class="col-md-12 col-lg-12" style="min-height:150px">
								<hr style="margin-bottom:0;"/>
								<div class="row">
					  				<h4 class="detail-section-title"><strong>Productos</strong></h4>
					  			</div>
								<h3 t-if="len(products_table) == 0" class="text-muted text-center">No se han encontrado productos</h3>
								<t t-foreach="products_table" t-as="tr_product">
									<t t-foreach="tr_product" t-as="td_product">
										<t t-if="td_product">
											<t t-set="product" t-value="td_product['product']" />
											<!-- GRID -->
											<div class="item col-lg-3 col-md-4 col-sm-6 col-xs-12">
												<div class="product">
													<div class="product-img">
														<a class="product-image" title="" t-attf-href="/shop/product/#{ slug(product) }">
															<span t-field="product.image" t-field-options='{"widget": "image", "class": "img img-responsive"}' />
														</a>    
													</div>
													
													<div class="pro-info">
														<div class="title">
															<a itemprop="name" t-attf-href="/shop/product/#{ slug(product) }" t-field="product.name"/>
														</div>
													</div>
												</div>
											</div>
										</t>
									</t>
								</t>
							</div>
						  	<div id="images" class="col-md-12 col-lg-12" style="min-height:150px">
						  		<hr style="margin-bottom:0;"/>
					  			<div class="row">
					  				<h4 class="detail-section-title"><strong>Imágenes</strong></h4>
					  			</div>
						  		<h3 t-if="len(establecimiento.images) == 0" class="text-muted text-center">No se han encontrado imágenes</h3>
						  		<div style="clear:both;">
							  		<t t-foreach="establecimiento.images" t-as="image">
							  			<div class="col-sm-4 col-md-2">
								  			<div class="thumbnail">
								  				<img t-attf-src="/web/binary/image?model=establecimiento.images&amp;id=#{image.id}&amp;field=image"/>
										   		<div class="caption">
										        	<strong t-esc="image.name"/>
										      </div>
										    </div>
									    </div>
							  		</t>
							  	</div>
							</div>
							<div id="location" class="col-md-12 col-lg-12" style="min-height:350px; clear:both;">
								<hr style="margin-bottom:0;"/>
					  			<div class="row">
					  				<h4 class="detail-section-title"><strong>Mapa</strong></h4>
					  			</div>
								<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="map" style="height:350px"></div>
							</div>
						</div>
					</section>
				</div>
				<div class="modal fade" tabindex="-1" role="dialog" id="map-viewer">
					<div class="modal-dialog">
				    	<div class="modal-content">
				      		<div class="modal-header">
				        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><i class="fa fa-close"></i></span></button>
				        		<h4 class="modal-title">Mapa</h4>
				      		</div>
				      		<div class="modal-body">
				        		<img id="map-img" />
				      		</div>
				      		<div class="modal-footer">
				        		<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
				      		</div>
				    	</div><!-- /.modal-content -->
				  	</div><!-- /.modal-dialog -->
				</div><!-- /.modal -->
			</t>
			
			<xpath expr="//html/head" position="inside">
				<script type='text/javascript'>
					google.maps.event.addDomListener(window, 'load', initializeGMapsEstablecimiento(<t t-esc="establecimiento.latitud" />, <t t-esc="establecimiento.longitud" />, '<t t-esc="establecimiento.partner_id.get_composed_address(',')" />'));
				</script>
			</xpath>
		</template>
		
    </data>
</openerp>
